<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mis Kits - OFFSZN</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
      /* Google Font 'Inter' */
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
      body {
        font-family: 'Inter', sans-serif;
      }
      /* Custom scrollbar for a sleek, modern look */
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.2);
      }
    </style>
  <!-- Import Map to load React from a CDN -->
  <script type="importmap">
  {
    "imports": {
      "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
      "react": "https://esm.sh/react@18.2.0"
    }
  }
  </script>
</head>
  <body class="bg-[#0a0a0a] text-[#e5e5e5]">
    <!-- The root element where the React app will be mounted -->
    <div id="root"></div>

    <!-- The entire React application logic is contained within this script tag -->
    <script type="module">
      import React, { useState, useEffect, useMemo } from 'react';
      import ReactDOM from 'react-dom/client';

      //================================================================
      // CONFIGURACIÓN DE API
      // Detecta si estamos en localhost o producción
      //================================================================
      const getApiUrl = () => {
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
          return 'http://localhost:3000/api';
        }
        return 'https://offszn-academy.onrender.com/api';
      };

      const API_URL = getApiUrl();

      //================================================================
      // TIPOS Y ESTADOS
      //================================================================
      const KitStatus = {
        Published: 'Published',
        Draft: 'Draft',
        Archived: 'Archived',
      };

      //================================================================
      // SERVICIOS DE API REALES
      // Basados en tu dashboard.js
      //================================================================
      
      // Obtener token de autenticación
      const getAuthToken = () => {
        return localStorage.getItem('authToken');
      };

      // Fetch datos del usuario (igual que en dashboard.js)
      const fetchUserData = async () => {
        console.log('API Call: Fetching user data...');
        const token = getAuthToken();
        
        if (!token) {
          console.error("No hay token de autenticación");
          window.location.replace('#'); // Cambiar a tu ruta de login
          throw new Error('No authenticated');
        }

        try {
          const response = await fetch(`${API_URL}/me`, {
            headers: { 'Authorization': `Bearer ${token}` }
          });

          if (!response.ok) {
            if (response.status === 401 || response.status === 403) {
              localStorage.removeItem('authToken');
              window.location.replace('#'); // Cambiar a tu ruta de login
            }
            throw new Error(`Error ${response.status}: No se pudieron obtener los datos del usuario.`);
          }

          const userData = await response.json();
          console.log('API Response: User data received.', userData);
          
          // Guardar userId para uso posterior
          if (userData.id) {
            localStorage.setItem('userId', userData.id);
          }
          
          return userData;
        } catch (error) {
          console.error('Error fetching user data:', error);
          throw error;
        }
      };

      // Fetch kits del usuario productor (nueva implementación)
      const fetchUserKits = async () => {
        console.log('API Call: Fetching user kits...');
        const token = getAuthToken();
        
        if (!token) {
          throw new Error('No authenticated');
        }

        try {
          // Esta ruta debe coincidir con tu backend - ajústala según tu API
          const response = await fetch(`${API_URL}/me/products`, {
            headers: { 'Authorization': `Bearer ${token}` }
          });

          if (!response.ok) {
            throw new Error('No se pudieron cargar tus kits.');
          }

          const kits = await response.json();
          console.log('API Response: User kits received.', kits);
          
          // Mapear los productos a la estructura de Kit esperada
          return kits.map(kit => ({
            id: kit.id || kit._id,
            name: kit.name,
            imageUrl: kit.image_url || `https://picsum.photos/seed/${kit.name}/400/300`,
            price: parseFloat(kit.price) || 0,
            sales: kit.sales || 0, // Si tu API no tiene sales, puedes dejarlo en 0
            status: kit.status || KitStatus.Published,
            createdAt: kit.created_at || kit.createdAt || new Date().toISOString(),
          }));
        } catch (error) {
          console.error('Error fetching user kits:', error);
          throw error;
        }
      };

      //================================================================
      // SKELETON COMPONENTS
      // Mantienen el estilo original
      //================================================================
      const UserInfoSkeleton = ({ type }) => {
        const navbarSkeleton = React.createElement('div', { className: "flex items-center gap-3 animate-pulse" },
          React.createElement('div', { className: "h-10 w-10 rounded-full bg-white/10" }),
          React.createElement('div', { className: "flex-1 space-y-2" },
            React.createElement('div', { className: "h-3 w-20 rounded bg-white/10" }),
            React.createElement('div', { className: "h-2 w-28 rounded bg-white/10" })
          )
        );
        const sidebarSkeleton = React.createElement('div', { className: "flex items-center gap-3 animate-pulse" },
          React.createElement('div', { className: "h-11 w-11 rounded-full bg-white/10" }),
          React.createElement('div', { className: "flex-1" },
            React.createElement('div', { className: "h-4 w-32 rounded bg-white/10" })
          )
        );
        return type === 'navbar' ? navbarSkeleton : sidebarSkeleton;
      };

      const KitCardSkeleton = () => {
        return React.createElement('div', { className: "bg-[#131313] border border-white/10 rounded-xl overflow-hidden animate-pulse" },
          React.createElement('div', { className: "w-full h-40 bg-white/10" }),
          React.createElement('div', { className: "p-4" },
            React.createElement('div', { className: "h-5 w-3/4 rounded bg-white/10 mb-2" }),
            React.createElement('div', { className: "mt-4 pt-3 border-t border-white/10 flex justify-between" },
              React.createElement('div', { className: "space-y-2" },
                React.createElement('div', { className: "h-2 w-10 rounded bg-white/10" }),
                React.createElement('div', { className: "h-4 w-14 rounded bg-white/10" })
              ),
              React.createElement('div', { className: "space-y-2 flex flex-col items-end" },
                React.createElement('div', { className: "h-2 w-8 rounded bg-white/10" }),
                React.createElement('div', { className: "h-4 w-12 rounded bg-white/10" })
              )
            )
          )
        );
      };
      
      //================================================================
      // UI COMPONENTS
      // Mantienen funcionalidad original
      //================================================================
      const KitEditModal = ({ kit, onClose }) => {
        if (!kit) return null;
        const handleContentClick = (e) => e.stopPropagation();
        return React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm", onClick: onClose },
          React.createElement('div', { className: "bg-[#131313] border border-white/10 rounded-xl w-full max-w-md m-4 p-6 text-center shadow-2xl shadow-violet-900/20", onClick: handleContentClick },
            React.createElement('div', { className: "flex justify-between items-center mb-4" },
              React.createElement('h2', { className: "text-xl font-bold text-white" }, "Editar Kit"),
              React.createElement('button', { onClick: onClose, className: "text-gray-500 hover:text-white transition-colors" }, React.createElement('i', { className: "fas fa-times" }))
            ),
            React.createElement('div', { className: "bg-white/5 p-4 rounded-lg my-6" },
              React.createElement('p', { className: "text-gray-400" }, "Estás editando:"),
              React.createElement('p', { className: "font-semibold text-white truncate" }, kit.name)
            ),
            React.createElement('i', { className: "fas fa-tools text-5xl text-violet-500 mb-4" }),
            React.createElement('h3', { className: "text-lg font-bold text-white mt-2" }, "Función en Desarrollo"),
            React.createElement('p', { className: "text-gray-400 mt-2 mb-6" }, "La capacidad de editar tus kits directamente desde aquí estará disponible muy pronto. ¡Estamos trabajando en ello!"),
            React.createElement('button', { onClick: onClose, className: "bg-violet-600 text-white font-bold px-6 py-2.5 rounded-lg hover:bg-violet-700 transition-colors w-full" }, "Entendido")
          )
        );
      };

      const statusStyles = {
        [KitStatus.Published]: { bg: 'bg-green-500/10', text: 'text-green-400', icon: 'fa-check-circle' },
        [KitStatus.Draft]: { bg: 'bg-yellow-500/10', text: 'text-yellow-400', icon: 'fa-pencil-alt' },
        [KitStatus.Archived]: { bg: 'bg-gray-500/10', text: 'text-gray-400', icon: 'fa-archive' },
      };

      const KitCard = ({ kit, onEdit }) => {
        const [dropdownOpen, setDropdownOpen] = useState(false);
        const { bg, text, icon } = statusStyles[kit.status];
        const handleEditClick = (e) => {
          e.preventDefault();
          onEdit(kit);
          setDropdownOpen(false);
        };
        const dropdownMenu = React.createElement('div', { className: "absolute right-0 mt-2 w-40 bg-[#1f1f1f] border border-white/10 rounded-lg shadow-xl z-10 p-1.5" },
          React.createElement('button', { onClick: handleEditClick, className: "w-full flex items-center gap-2 px-3 py-1.5 text-sm text-gray-300 hover:bg-white/10 rounded-md text-left" }, React.createElement('i', { className: "fas fa-edit w-4" }), " Editar"),
          React.createElement('a', { href: "#", className: "flex items-center gap-2 px-3 py-1.5 text-sm text-gray-300 hover:bg-white/10 rounded-md" }, React.createElement('i', { className: "fas fa-chart-bar w-4" }), " Analíticas"),
          React.createElement('a', { href: "#", className: "flex items-center gap-2 px-3 py-1.5 text-sm text-red-500 hover:bg-red-500/10 rounded-md mt-1" }, React.createElement('i', { className: "fas fa-trash-alt w-4" }), " Eliminar")
        );
        return React.createElement('div', { className: "bg-[#131313] border border-white/10 rounded-xl overflow-hidden group transition-all duration-300 hover:border-violet-500/50 hover:shadow-2xl hover:shadow-violet-900/20" },
          React.createElement('div', { className: "relative" },
            React.createElement('img', { src: kit.imageUrl, alt: kit.name, className: "w-full h-40 object-cover" }),
            React.createElement('div', { className: `absolute top-2 left-2 flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold ${bg} ${text} backdrop-blur-sm` },
              React.createElement('i', { className: `fas ${icon}` }),
              React.createElement('span', null, kit.status)
            )
          ),
          React.createElement('div', { className: "p-4" },
            React.createElement('div', { className: "flex justify-between items-start" },
              React.createElement('h3', { className: "font-bold text-white mb-1 truncate pr-2", title: kit.name }, kit.name),
              React.createElement('div', { className: "relative" },
                React.createElement('button', { onClick: () => setDropdownOpen(!dropdownOpen), className: "text-gray-500 hover:text-white transition-colors h-6 w-6 rounded-full flex items-center justify-center hover:bg-white/10" },
                  React.createElement('i', { className: "fas fa-ellipsis-v" })
                ),
                dropdownOpen && dropdownMenu
              )
            ),
            React.createElement('div', { className: "flex justify-between items-center text-sm mt-3 pt-3 border-t border-white/10" },
              React.createElement('div', { className: "flex flex-col" },
                React.createElement('span', { className: "text-xs text-gray-500" }, "Precio"),
                React.createElement('span', { className: "font-semibold text-green-400" }, `$${kit.price.toFixed(2)}`)
              ),
              React.createElement('div', { className: "flex flex-col items-end" },
                React.createElement('span', { className: "text-xs text-gray-500" }, "Ventas"),
                React.createElement('span', { className: "font-semibold text-white" }, kit.sales)
              )
            )
          )
        );
      };

      // Menú del sidebar - todas las rutas con "#" temporal
      const menuSections = [
        { title: 'Principal', items: [
          { icon: 'fa-th-large', label: 'Dashboard', href: '#' }, 
          { icon: 'fa-music', label: 'Mis Kits', href: '#', active: true }, 
          { icon: 'fa-chart-line', label: 'Analíticas', href: '#', soon: true }, 
          { icon: 'fa-heart', label: 'Favoritos', href: '#' }, 
          { icon: 'fa-history', label: 'Historial', href: '#', soon: true }
        ]},
        { title: 'Colaboración', items: [
          { icon: 'fa-users', label: 'Colaboraciones', href: '#' }
        ]},
        { title: 'Compras', items: [
          { icon: 'fa-shopping-bag', label: 'Mis Compras', href: '#' }, 
          { icon: 'fa-gift', label: 'Gift Cards', href: '#' }, 
          { icon: 'fa-envelope', label: 'Mensajes', href: '#' }
        ]},
        { title: 'Configuración', items: [
          { icon: 'fa-cog', label: 'Configuración', href: '#' }, 
          { icon: 'fa-book-open', label: 'Blog', href: '#', soon: true }
        ]}
      ];

      //================================================================
      // SIDEBAR COMPONENT
      // Ahora carga datos reales del usuario
      //================================================================
      const Sidebar = ({ user, loading }) => {
        const userInitial = user ? (user.first_name || user.nickname || 'U').charAt(0).toUpperCase() : '';
        
        // Cargar saldo desde gift cards (igual que en dashboard.js)
        const [walletBalance, setWalletBalance] = useState(0);
        
        useEffect(() => {
          try {
            const saved = localStorage.getItem('offszn_giftcards_state');
            if (saved) {
              const appState = JSON.parse(saved);
              setWalletBalance(appState.totalBalance || 0);
            }
          } catch (err) {
            console.error('Error al cargar saldo:', err);
          }
        }, []);

        return React.createElement('aside', { className: "hidden md:flex flex-col sticky top-[65px] h-[calc(100vh-65px)] bg-[rgba(15,15,15,0.6)] border-r border-white/10" },
          React.createElement('div', null,
            React.createElement('div', { className: "p-5 border-b border-white/10" },
              loading ? React.createElement(UserInfoSkeleton, { type: "sidebar" }) : React.createElement('div', { className: "flex items-center gap-3" },
                React.createElement('div', { className: "flex h-11 w-11 items-center justify-center rounded-full bg-violet-600 font-bold text-white text-lg" }, userInitial),
                React.createElement('div', null, React.createElement('p', { className: "font-semibold text-white" }, `${user?.first_name || ''} ${user?.last_name || ''}`.trim() || user?.nickname))
              )
            ),
            React.createElement('div', { className: "p-5 border-b border-white/10 bg-violet-600/5" },
              React.createElement('div', { className: "text-xs font-semibold uppercase text-gray-400 mb-1.5" }, "Saldo Disponible"),
              loading ? React.createElement('div', { className: "h-8 w-32 animate-pulse rounded-md bg-white/10" }) : React.createElement('div', { className: "text-3xl font-bold text-white" }, `$${walletBalance.toFixed(2)}`)
            )
          ),
          React.createElement('nav', { className: "flex-grow p-3 overflow-y-auto custom-scrollbar" },
            menuSections.map((section, index) => React.createElement('div', { key: section.title },
              index > 0 && React.createElement('div', { className: "my-3 h-px bg-white/10" }),
              React.createElement('h3', { className: "px-2 pt-4 pb-2 text-xs font-bold uppercase text-gray-500 tracking-wider" }, section.title),
              React.createElement('ul', null, section.items.map(item => React.createElement('li', { key: item.label },
                React.createElement('a', { href: item.href, className: `flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${item.active ? 'bg-violet-600/10 text-white' : 'text-gray-400 hover:bg-white/5 hover:text-white'} ${item.soon ? 'opacity-50 cursor-not-allowed' : ''}` },
                  React.createElement('i', { className: `fas ${item.icon} w-5 text-center text-base` }),
                  React.createElement('span', null, item.label),
                  item.soon && React.createElement('span', { className: "ml-auto text-xs font-semibold bg-white/10 text-gray-400 px-2 py-0.5 rounded-full" }, "Pronto")
                )
              )))
            ))
          ),
          React.createElement('div', { className: "p-4 border-t border-white/10" },
            React.createElement('a', { href: "#", className: "flex items-center justify-center gap-3 rounded-lg px-3 py-2.5 text-sm font-semibold text-red-400 border border-red-500/20 bg-red-500/5 transition-colors hover:bg-red-500/10 hover:border-red-500/40" },
              React.createElement('i', { className: "fas fa-sign-out-alt w-5 text-center" }),
              React.createElement('span', null, "Cerrar Sesión")
            )
          )
        );
      };

      //================================================================
      // NAVBAR COMPONENT
      // Ahora carga datos reales del usuario
      //================================================================
      const Navbar = ({ user, loading }) => {
        const [userDropdownOpen, setUserDropdownOpen] = useState(false);
        const userInitial = user ? (user.first_name || user.nickname || 'U').charAt(0).toUpperCase() : '';
        
        const dropdownMenu = React.createElement('div', { className: "absolute right-0 mt-3 w-64 rounded-xl border border-white/10 bg-[rgba(20,20,20,0.98)] p-3 shadow-2xl backdrop-blur-xl" },
          React.createElement('div', { className: "mb-2 flex items-center gap-3 border-b border-white/10 p-3" },
            loading ? React.createElement(UserInfoSkeleton, { type: "navbar" }) : React.createElement(React.Fragment, null,
              React.createElement('div', { className: "flex h-10 w-10 items-center justify-center rounded-full bg-violet-600 font-bold text-white" }, userInitial),
              React.createElement('div', null,
                React.createElement('p', { className: "text-sm font-semibold text-white" }, user?.nickname),
                React.createElement('p', { className: "text-xs text-gray-500" }, user?.email)
              )
            )
          ),
          React.createElement('a', { href: "#", className: "flex items-center gap-3 rounded-lg px-3 py-2 text-sm text-gray-400 transition-colors hover:bg-white/5 hover:text-white" }, React.createElement('i', { className: "fas fa-user-circle w-5 text-center" }), " Mi Perfil"),
          React.createElement('a', { href: "#", className: "flex items-center gap-3 rounded-lg px-3 py-2 text-sm text-gray-400 transition-colors hover:bg-white/5 hover:text-white" }, React.createElement('i', { className: "fas fa-th-large w-5 text-center" }), " Dashboard"),
          React.createElement('a', { href: "#", className: "flex items-center gap-3 rounded-lg px-3 py-2 text-sm text-gray-400 transition-colors hover:bg-white/5 hover:text-white" }, React.createElement('i', { className: "fas fa-cog w-5 text-center" }), " Configuración"),
          React.createElement('div', { className: "my-2 h-px bg-white/10" }),
          React.createElement('a', { href: "#", className: "flex items-center gap-3 rounded-lg px-3 py-2 text-sm text-red-500 transition-colors hover:bg-red-500/10" }, React.createElement('i', { className: "fas fa-sign-out-alt w-5 text-center" }), " Cerrar Sesión")
        );
        
        return React.createElement('nav', { className: "sticky top-0 z-50 flex items-center justify-between bg-[rgba(0,0,0,0.98)] px-6 py-3 md:px-12 backdrop-blur-xl border-b border-white/10" },
          React.createElement('div', { className: "logo" }, React.createElement('a', { href: "#", className: "text-2xl font-extrabold tracking-tight text-white" }, "OFFSZN")),
          React.createElement('div', { className: "hidden lg:flex items-center gap-10" },
            React.createElement('div', { className: "relative w-96" },
              React.createElement('input', { type: "text", placeholder: "Buscar beats, kits, productores...", className: "w-full rounded-lg border border-white/10 bg-white/5 px-4 py-2 text-sm text-white outline-none transition-all placeholder:text-gray-500 focus:border-violet-500/50 focus:bg-white/[0.08]" }),
              React.createElement('i', { className: "fas fa-search absolute right-4 top-1/2 -translate-y-1/2 text-gray-500" })
            )
          ),
          React.createElement('div', { className: "flex items-center gap-3" },
            React.createElement('a', { href: "#", className: "flex h-9 w-9 items-center justify-center rounded-lg border border-white/10 bg-white/5 text-gray-400 transition-colors hover:bg-white/[0.08] hover:text-white" }, React.createElement('i', { className: "fas fa-bell" })),
            React.createElement('a', { href: "#", className: "flex h-9 w-9 items-center justify-center rounded-lg border border-white/10 bg-white/5 text-gray-400 transition-colors hover:bg-white/[0.08] hover:text-white" }, React.createElement('i', { className: "fas fa-shopping-cart" })),
            React.createElement('div', { className: "relative" },
              React.createElement('button', { onClick: () => setUserDropdownOpen(!userDropdownOpen), className: "flex h-9 w-9 items-center justify-center rounded-full bg-violet-600 text-white font-bold transition-transform hover:scale-105" }, loading ? React.createElement('i', { className: "fa-solid fa-spinner fa-spin" }) : userInitial),
              userDropdownOpen && dropdownMenu
            )
          )
        );
      };

      //================================================================
      // MY KITS PAGE - COMPONENTE PRINCIPAL
      // Ahora carga kits reales de la API
      //================================================================
      const MyKitsPage = () => {
        const [kits, setKits] = useState([]);
        const [loading, setLoading] = useState(true);
        const [editingKit, setEditingKit] = useState(null);
        const [searchTerm, setSearchTerm] = useState('');
        const [statusFilter, setStatusFilter] = useState('All');
        const [sortOrder, setSortOrder] = useState('createdAt_desc');
        const [error, setError] = useState(null);

        // Cargar kits desde la API al montar el componente
        useEffect(() => {
          const loadKits = async () => {
            setLoading(true);
            setError(null);
            try {
              const userKits = await fetchUserKits();
              setKits(userKits);
              console.log(`✅ ${userKits.length} kits cargados correctamente`);
            } catch (err) {
              console.error('Error cargando kits:', err);
              setError(err.message);
            } finally {
              setLoading(false);
            }
          };
          loadKits();
        }, []);

        // Filtrar y ordenar kits (lógica original mantenida)
        const filteredAndSortedKits = useMemo(() => {
          return kits
            .filter(kit => kit.name.toLowerCase().includes(searchTerm.toLowerCase()) && (statusFilter === 'All' || kit.status === statusFilter))
            .sort((a, b) => {
              switch (sortOrder) {
                case 'createdAt_desc': return new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime();
                case 'createdAt_asc': return new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime();
                case 'sales_desc': return b.sales - a.sales;
                case 'price_desc': return b.price - a.price;
                case 'price_asc': return a.price - b.price;
                default: return 0;
              }
            });
        }, [kits, searchTerm, statusFilter, sortOrder]);

        const handleEditKit = (kit) => setEditingKit(kit);
        const handleCloseModal = () => setEditingKit(null);

        // Botones de filtro por estado
        const StatusButton = ({ status, label }) => React.createElement('button', { 
          onClick: () => setStatusFilter(status), 
          className: `px-4 py-2 text-sm font-semibold rounded-lg transition-colors ${statusFilter === status ? 'bg-violet-600 text-white' : 'bg-white/5 text-gray-400 hover:bg-white/10'}` 
        }, label);

        // Renderizado condicional del grid de kits
        let kitGrid;
        
        if (loading) {
          // Mostrar skeletons mientras carga
          kitGrid = React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" }, 
            Array.from({ length: 8 }).map((_, index) => React.createElement(KitCardSkeleton, { key: index }))
          );
        } else if (error) {
          // Mostrar error si hubo problemas al cargar
          kitGrid = React.createElement('div', { className: "text-center py-20 bg-red-500/5 border border-red-500/20 rounded-xl" },
            React.createElement('i', { className: "fas fa-exclamation-triangle text-5xl text-red-500 mb-4" }),
            React.createElement('h3', { className: "text-xl font-bold text-white" }, "Error al cargar kits"),
            React.createElement('p', { className: "text-gray-400 mt-2" }, error),
            React.createElement('button', { 
              onClick: () => window.location.reload(),
              className: "mt-4 bg-violet-600 text-white px-6 py-2 rounded-lg hover:bg-violet-700 transition-colors"
            }, "Reintentar")
          );
        } else if (filteredAndSortedKits.length > 0) {
          // Mostrar kits cuando hay resultados
          kitGrid = React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" }, 
            filteredAndSortedKits.map(kit => React.createElement(KitCard, { key: kit.id, kit: kit, onEdit: handleEditKit }))
          );
        } else {
          // Estado vacío cuando no hay kits o no coinciden con los filtros
          kitGrid = React.createElement('div', { className: "text-center py-20 bg-white/5 rounded-xl" },
            React.createElement('i', { className: "fas fa-box-open text-5xl text-gray-600 mb-4" }),
            React.createElement('h3', { className: "text-xl font-bold text-white" }, "No se encontraron kits"),
            React.createElement('p', { className: "text-gray-400 mt-2" }, 
              kits.length === 0 
                ? "Aún no has subido ningún kit. ¡Comienza ahora!" 
                : "Prueba a cambiar los filtros para ver más resultados."
            )
          );
        }
        
        return React.createElement('div', null,
          // Breadcrumb navigation
          React.createElement('div', { className: "breadcrumb flex items-center gap-2 text-sm text-gray-500 mb-6" },
            React.createElement('a', { href: "#", className: "hover:text-violet-400" }, React.createElement('i', { className: "fas fa-home" }), " Dashboard"),
            React.createElement('span', null, React.createElement('i', { className: "fas fa-chevron-right text-xs" })),
            React.createElement('span', { className: "font-semibold text-white" }, "Mis Kits")
          ),
          
          // Header con título y botón de subir
          React.createElement('header', { className: "flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4" },
            React.createElement('div', null,
              React.createElement('h1', { className: "text-3xl font-extrabold text-white tracking-tight" }, "Mis Kits"),
              React.createElement('p', { className: "text-gray-400 mt-1" }, "Gestiona los productos que has subido al marketplace.")
            ),
            React.createElement('button', { 
              className: "flex items-center gap-2 bg-violet-600 text-white font-bold px-5 py-3 rounded-lg hover:bg-violet-700 transition-all transform hover:scale-105",
              onClick: () => alert('Funcionalidad de subir kit en desarrollo')
            }, 
              React.createElement('i', { className: "fas fa-cloud-upload-alt" }), 
              "Subir Nuevo Kit"
            )
          ),
          
          // Barra de filtros y búsqueda
          React.createElement('div', { className: "bg-white/5 border border-white/10 rounded-xl p-4 mb-6" },
            React.createElement('div', { className: "flex flex-col md:flex-row gap-4" },
              // Campo de búsqueda
              React.createElement('div', { className: "relative flex-grow" },
                React.createElement('i', { className: "fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-500" }),
                React.createElement('input', { 
                  type: "text", 
                  placeholder: "Buscar por nombre...", 
                  value: searchTerm, 
                  onChange: (e) => setSearchTerm(e.target.value), 
                  className: "w-full bg-black/20 border border-white/10 rounded-lg pl-10 pr-4 py-2.5 text-sm outline-none focus:ring-2 focus:ring-violet-500" 
                })
              ),
              
              // Botones de filtro por estado
              React.createElement('div', { className: "flex items-center gap-2 flex-wrap" },
                React.createElement(StatusButton, { status: "All", label: "Todos" }),
                React.createElement(StatusButton, { status: KitStatus.Published, label: "Publicados" }),
                React.createElement(StatusButton, { status: KitStatus.Draft, label: "Borradores" }),
                React.createElement(StatusButton, { status: KitStatus.Archived, label: "Archivados" })
              ),
              
              // Selector de ordenamiento
              React.createElement('div', null,
                React.createElement('select', { 
                  value: sortOrder, 
                  onChange: (e) => setSortOrder(e.target.value), 
                  className: "w-full md:w-auto bg-black/20 border border-white/10 rounded-lg px-3 py-2.5 text-sm outline-none focus:ring-2 focus:ring-violet-500" 
                },
                  React.createElement('option', { value: "createdAt_desc" }, "Más Recientes"),
                  React.createElement('option', { value: "createdAt_asc" }, "Más Antiguos"),
                  React.createElement('option', { value: "sales_desc" }, "Más Vendidos"),
                  React.createElement('option', { value: "price_desc" }, "Precio: Mayor a Menor"),
                  React.createElement('option', { value: "price_asc" }, "Precio: Menor a Mayor")
                )
              )
            )
          ),
          
          // Grid de kits (skeleton, error, resultados o estado vacío)
          kitGrid,
          
          // Modal de edición
          React.createElement(KitEditModal, { kit: editingKit, onClose: handleCloseModal })
        );
      };

      //================================================================
      // APP ROOT COMPONENT
      // Carga datos del usuario al inicio
      //================================================================
      const App = () => {
        const [user, setUser] = useState(null);
        const [loading, setLoading] = useState(true);

        useEffect(() => {
          const loadUser = async () => {
            setLoading(true);
            try {
              const userData = await fetchUserData();
              setUser(userData);
              console.log('✅ Usuario cargado correctamente');
            } catch (error) {
              console.error('❌ Error cargando usuario:', error);
              // Si hay error de autenticación, mantener loading pero no redirigir
              // ya que fetchUserData maneja la redirección
            } finally {
              setLoading(false);
            }
          };
          loadUser();
        }, []);

        return React.createElement('div', { className: "min-h-screen bg-[#0a0a0a]" },
          React.createElement(Navbar, { user, loading }),
          React.createElement('div', { className: "grid md:grid-cols-[260px_1fr]" },
            React.createElement(Sidebar, { user, loading }),
            React.createElement('main', { className: "main-content px-6 py-9 md:px-12" },
              React.createElement(MyKitsPage)
            )
          )
        );
      };

      //================================================================
      // RENDERIZAR LA APLICACIÓN
      //================================================================
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(React.StrictMode, null, React.createElement(App)));

    </script>
  </body>
</html>
